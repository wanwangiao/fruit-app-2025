(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{9187:function(e,t,a){Promise.resolve().then(a.bind(a,2219))},2219:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var s=a(7437),r=a(2265);function n(e){let{isOpen:t,onClose:a,title:n,onSubmit:i,fields:l,submitText:c="提交"}=e,[o,d]=(0,r.useState)(()=>{let e={};return l.forEach(t=>{e[t.name]=void 0!==t.initialValue?t.initialValue:""}),e});if(!t)return null;let x=e=>{let{name:t,value:a,type:s,checked:r}=e.target;d(e=>({...e,[t]:"checkbox"===s?r:a}))};return(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 md:w-1/3 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:n}),(0,s.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i(o),a()},className:"p-6 space-y-4",children:[l.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:e.name,className:"block text-sm font-medium text-gray-700",children:e.label}),(0,s.jsx)("input",{type:e.type,name:e.name,id:e.name,value:o[e.name],onChange:x,placeholder:e.placeholder,disabled:e.disabled,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900",required:"checkbox"!==e.type})]},e.name)),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"bg-green-600 text-white py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:c})]})]})]})})}var i=a(9320);let l=[{id:1,name:"高麗菜",minStock:50,batches:[{quantity:80,unitCost:25,purchaseDate:"2025-08-01"},{quantity:20,unitCost:30,purchaseDate:"2025-08-05"},{quantity:10,unitCost:28,purchaseDate:"2025-08-07"}]},{id:2,name:"蘋果",minStock:30,batches:[{quantity:50,unitCost:60,purchaseDate:"2025-08-02"},{quantity:15,unitCost:62,purchaseDate:"2025-08-06"}]},{id:3,name:"豬五花",minStock:20,batches:[{quantity:30,unitCost:90,purchaseDate:"2025-08-03"}]},{id:4,name:"鮭魚片",minStock:10,batches:[{quantity:15,unitCost:200,purchaseDate:"2025-08-04"}]},{id:5,name:"香菇貢丸",minStock:40,batches:[{quantity:80,unitCost:70,purchaseDate:"2025-08-01"}]},{id:6,name:"金針菇",minStock:60,batches:[{quantity:120,unitCost:20,purchaseDate:"2025-08-02"}]}];function c(){let[e,t]=(0,r.useState)(l),[a,c]=(0,r.useState)(""),[o,d]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),[y,b]=(0,r.useState)("all"),f=(0,r.useMemo)(()=>e.map(e=>({...e,currentStock:e.batches.reduce((e,t)=>e+t.quantity,0)})),[e]),j=(0,r.useMemo)(()=>e.reduce((e,t)=>e+t.batches.reduce((e,t)=>e+t.quantity*t.unitCost,0),0),[e]),N=(0,r.useMemo)(()=>f.filter(e=>e.currentStock<=e.minStock),[f]),w=(0,r.useMemo)(()=>f.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())),[f,a]),v=(0,r.useMemo)(()=>{if(!p)return[];let e=new Date,t=new Date;switch(y){case"day":t.setHours(0,0,0,0);break;case"week":t.setDate(e.getDate()-e.getDay()),t.setHours(0,0,0,0);break;case"month":t.setDate(1),t.setHours(0,0,0,0);break;default:return p.batches}return p.batches.filter(a=>{let s=new Date(a.purchaseDate);return s>=t&&s<=e})},[p,y]),k=(0,r.useMemo)(()=>v.reduce((e,t)=>e+t.quantity*t.unitCost,0),[v]);return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"庫存管理"}),(0,s.jsxs)("div",{className:"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6",role:"alert",children:[(0,s.jsx)("p",{className:"font-bold",children:"目前總庫存金額"}),(0,s.jsxs)("p",{className:"text-3xl font-bold mt-2",children:["NT$ ",j.toLocaleString()]})]}),N.length>0&&(0,s.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6",role:"alert",children:[(0,s.jsx)("p",{className:"font-bold",children:"低庫存警示！"}),(0,s.jsx)("p",{children:"以下商品庫存量低於最低庫存設定："}),(0,s.jsx)("ul",{className:"list-disc list-inside",children:N.map(e=>(0,s.jsxs)("li",{children:[e.name," (目前庫存: ",e.currentStock,")"]},e.id))})]}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:(0,s.jsx)("input",{type:"text",placeholder:"搜尋商品名稱...",className:"w-full border border-gray-300 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900",value:a,onChange:e=>c(e.target.value)})}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"商品名稱"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"目前庫存"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"最低庫存"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[w.map(e=>(0,s.jsxs)("tr",{className:e.currentStock<=e.minStock?"bg-yellow-50":"",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.currentStock}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.minStock}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,s.jsx)("button",{onClick:()=>{g(e),d(!0)},className:"text-green-600 hover:text-green-900 mr-4",children:"入庫"}),(0,s.jsx)("button",{onClick:()=>{g(e),u(!0)},className:"text-orange-600 hover:text-orange-900 mr-4",children:"出庫"}),(0,s.jsx)("button",{onClick:()=>{g(e),h(!0),b("all")},className:"text-blue-600 hover:text-blue-900",children:"歷史"})]})]},e.id)),0===w.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"沒有找到符合條件的庫存商品。"})})]})]})}),p&&(0,s.jsx)(n,{isOpen:o,onClose:()=>d(!1),title:"為 ".concat(p.name," 入庫"),onSubmit:e=>{let{quantity:a,unitCost:s,totalCost:r,purchaseDate:n}=e,i=Number(a),l=Number(s);if(r&&!s)l=Number(r)/i;else if(s&&!r);else if(!s&&!r){alert("請輸入單品成本或總金額。");return}t(e=>e.map(e=>e.id===p.id?{...e,batches:[...e.batches,{quantity:i,unitCost:l,purchaseDate:n||new Date().toISOString().split("T")[0]}]}:e)),alert("已為 ".concat(p.name," 入庫 ").concat(i," 個。"))},fields:[{name:"quantity",label:"入庫數量",type:"number",placeholder:"例如: 50"},{name:"unitCost",label:"單品成本",type:"number",placeholder:"例如: 25"},{name:"totalCost",label:"總金額",type:"number",placeholder:"例如: 1250"},{name:"purchaseDate",label:"入庫日期",type:"date",initialValue:new Date().toISOString().split("T")[0]}],submitText:"確認入庫"}),p&&(0,s.jsx)(n,{isOpen:x,onClose:()=>u(!1),title:"為 ".concat(p.name," 出庫"),onSubmit:e=>{let{quantity:a}=e,s=Number(a);t(e=>e.map(e=>{if(e.id===p.id){let t=[...e.batches].sort((e,t)=>new Date(e.purchaseDate).getTime()-new Date(t.purchaseDate).getTime()),a=[],r=s;for(let e of t){if(r<=0){a.push(e);continue}e.quantity<=r?r-=e.quantity:(a.push({...e,quantity:e.quantity-r}),r=0)}return r>0&&alert("出庫數量超過庫存！實際出庫 ".concat(s-r," 個。")),{...e,batches:a.filter(e=>e.quantity>0)}}return e})),alert("已為 ".concat(p.name," 出庫 ").concat(s," 個。"))},fields:[{name:"quantity",label:"出庫數量",type:"number",placeholder:"例如: 10"}],submitText:"確認出庫"}),p&&(0,s.jsxs)(i.Z,{isOpen:m,onClose:()=>h(!1),title:"".concat(p.name," - 庫存歷史"),children:[(0,s.jsxs)("div",{className:"mb-4 flex justify-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>b("all"),className:"px-4 py-2 rounded-full text-sm font-medium ".concat("all"===y?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"全部"}),(0,s.jsx)("button",{onClick:()=>b("day"),className:"px-4 py-2 rounded-full text-sm font-medium ".concat("day"===y?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"今天"}),(0,s.jsx)("button",{onClick:()=>b("week"),className:"px-4 py-2 rounded-full text-sm font-medium ".concat("week"===y?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"本週"}),(0,s.jsx)("button",{onClick:()=>b("month"),className:"px-4 py-2 rounded-full text-sm font-medium ".concat("month"===y?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"本月"})]}),(0,s.jsxs)("div",{className:"mb-4 text-right text-lg font-semibold text-gray-800",children:["篩選後總成本: NT$ ",k.toLocaleString()]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"日期"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"類型"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"數量"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"單品成本"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"總價"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.purchaseDate}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:"入庫"}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["+",e.quantity]}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["NT$ ",e.unitCost]}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["NT$ ",(e.quantity*e.unitCost).toLocaleString()]})]},t)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"沒有找到符合篩選條件的歷史記錄。"})})})]})}),(0,s.jsxs)("div",{className:"mt-6 p-4 border-t border-gray-200",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"銷售與利潤概覽 (未來功能)"}),(0,s.jsx)("p",{className:"text-gray-600",children:"此處將顯示篩選時間範圍內的銷售金額和毛利。"}),(0,s.jsx)("p",{className:"text-gray-600",children:"需要整合訂單管理功能後才能提供。"})]})]})]})}},9320:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437);function r(e){let{isOpen:t,onClose:a,children:r,title:n=""}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 md:w-2/3 lg:w-1/2 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:n}),(0,s.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:"\xd7"})]}),(0,s.jsx)("div",{className:"p-6",children:r})]})}):null}a(2265)}},function(e){e.O(0,[971,23,744],function(){return e(e.s=9187)}),_N_E=e.O()}]);