(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[122],{5467:function(e,t,r){Promise.resolve().then(r.bind(r,8723))},8723:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(7437),i=r(2265),a=r(9320),o=r(6554);function n(e){let{initialData:t,onSave:r,onCancel:a}=e,[n,c]=(0,i.useState)(t||{name:"",category:"",price:"",isPriceByWeight:!1,imageUrl:"",description:"",stock:"",options:[]}),l=(0,o.CP)();(0,i.useEffect)(()=>{t&&c(t)},[t]);let d=e=>{let{name:t,value:r,type:s}=e.target;"checkbox"===s?c(r=>({...r,[t]:e.target.checked})):c(e=>({...e,[t]:r}))},u=(e,t)=>{let r=[...n.options];r[e].groupName=t,c(e=>({...e,options:r}))},m=(e,t)=>{let r=[...n.options];r[e].type=t,c(e=>({...e,options:r}))},p=(e,t)=>{let r=[...n.options];r[e].required=t,c(e=>({...e,options:r}))},g=e=>{let t=n.options.filter((t,r)=>r!==e);c(e=>({...e,options:t}))},x=e=>{let t=[...n.options];t[e].values.push(""),c(e=>({...e,options:t}))},h=(e,t,r)=>{let s=[...n.options];s[e].values[t]=r,c(e=>({...e,options:s}))},y=(e,t)=>{let r=[...n.options];r[e].values=r[e].values.filter((e,r)=>r!==t),c(e=>({...e,options:r}))};return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(n)},className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"商品名稱"}),(0,s.jsx)("input",{type:"text",name:"name",id:"name",value:n.name,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"所屬分類"}),(0,s.jsxs)("select",{name:"category",id:"category",value:n.category,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900",required:!0,children:[(0,s.jsx)("option",{value:"",children:"請選擇分類"}),l.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"價格"}),(0,s.jsx)("input",{type:"number",name:"price",id:"price",value:n.isPriceByWeight?"":n.price,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900",disabled:n.isPriceByWeight})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",name:"isPriceByWeight",id:"isPriceByWeight",checked:n.isPriceByWeight,onChange:d,className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"isPriceByWeight",className:"ml-2 block text-sm text-gray-900",children:"此商品為時價/秤重商品 (價格將於訂單更新)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700",children:"商品圖片 URL"}),(0,s.jsx)("input",{type:"text",name:"imageUrl",id:"imageUrl",value:n.imageUrl,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"商品描述"}),(0,s.jsx)("textarea",{name:"description",id:"description",rows:3,value:n.description,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700",children:"庫存數量"}),(0,s.jsx)("input",{type:"number",name:"stock",id:"stock",value:n.stock,onChange:d,className:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-gray-900"})]}),(0,s.jsxs)("div",{className:"border border-gray-200 p-4 rounded-lg bg-gray-50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"商品選項"}),n.options.map((e,t)=>(0,s.jsxs)("div",{className:"mb-4 p-3 border border-gray-300 rounded-lg bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"選項組名稱 (例如: 甜度)",value:e.groupName,onChange:e=>u(t,e.target.value),className:"flex-1 border border-gray-300 p-2 rounded-md text-gray-900"}),(0,s.jsx)("button",{type:"button",onClick:()=>g(t),className:"ml-2 text-red-500 hover:text-red-700 text-sm",children:"刪除此組"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mb-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"選擇類型:"}),(0,s.jsxs)("select",{value:e.type,onChange:e=>m(t,e.target.value),className:"border border-gray-300 p-1 rounded-md text-gray-900 text-sm",children:[(0,s.jsx)("option",{value:"single",children:"單選 (只能選一個)"}),(0,s.jsx)("option",{value:"multiple",children:"複選 (可選多個)"})]}),(0,s.jsx)("input",{type:"checkbox",checked:e.required,onChange:e=>p(t,e.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),(0,s.jsx)("label",{className:"text-sm text-gray-900",children:"是否必選"})]}),(0,s.jsx)("div",{className:"space-y-2",children:e.values.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"選項值 (例如: 微糖)",value:e,onChange:e=>h(t,r,e.target.value),className:"flex-1 border border-gray-300 p-2 rounded-md text-gray-900"}),(0,s.jsx)("button",{type:"button",onClick:()=>y(t,r),className:"text-red-500 hover:text-red-700 text-sm",children:"刪除"})]},r))}),(0,s.jsx)("button",{type:"button",onClick:()=>x(t),className:"mt-3 w-full bg-blue-500 text-white py-1 rounded-md hover:bg-blue-600 text-sm",children:"+ 新增選項值"})]},t)),(0,s.jsx)("button",{type:"button",onClick:()=>{c(e=>({...e,options:[...e.options,{groupName:"",type:"single",required:!0,values:[]}]}))},className:"w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors mt-4",children:"+ 新增選項組"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"bg-green-600 text-white py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"儲存商品"})]})]})}function c(){let[e,t]=(0,i.useState)((0,o.Xp)()),[r,c]=(0,i.useState)(""),[l,d]=(0,i.useState)("所有分類"),[u,m]=(0,i.useState)(!1),[p,g]=(0,i.useState)(null),x=["所有分類",...(0,o.CP)().map(e=>e.name)],h=(0,i.useMemo)(()=>e.filter(e=>{let t=e.name.toLowerCase().includes(r.toLowerCase()),s="所有分類"===l||e.category===l;return t&&s}),[e,r,l]),y=(e,r)=>{window.confirm("確定要刪除商品 '".concat(r,"' 嗎？這將無法復原！"))&&((0,o.Ir)(e),t((0,o.Xp)()),alert("商品 '".concat(r,"' 已刪除！")))},b=e=>{g(e),m(!0)};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"商品管理"}),(0,s.jsx)("button",{onClick:()=>{m(!0),g(null)},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"+ 新增商品"})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6 flex space-x-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"搜尋商品名稱...",className:"flex-1 border border-gray-300 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900",value:r,onChange:e=>c(e.target.value)}),(0,s.jsx)("select",{className:"border border-gray-300 p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900",value:l,onChange:e=>d(e.target.value),children:x.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"圖片"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"名稱"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"分類"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"價格"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"庫存"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[h.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("img",{src:e.imageUrl,alt:e.name,className:"h-10 w-10 rounded-full object-cover"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.category}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["NT$ ",e.price]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.stock}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,s.jsx)("button",{onClick:()=>b(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"編輯"}),(0,s.jsx)("button",{onClick:()=>y(e.id,e.name),className:"text-red-600 hover:text-red-900",children:"刪除"})]})]},e.id)),0===h.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"沒有找到符合條件的商品。"})})]})]})}),(0,s.jsx)(a.Z,{isOpen:u,onClose:()=>m(!1),title:p?"編輯商品":"新增商品",children:(0,s.jsx)(n,{initialData:p,onSave:e=>{p?((0,o.nM)(e),alert("商品更新成功！")):((0,o.gK)(e),alert("商品新增成功！")),t((0,o.Xp)()),m(!1),g(null)},onCancel:()=>m(!1)})})]})}},9320:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var s=r(7437);function i(e){let{isOpen:t,onClose:r,children:i,title:a=""}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-11/12 md:w-2/3 lg:w-1/2 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:a}),(0,s.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none",children:"\xd7"})]}),(0,s.jsx)("div",{className:"p-6",children:i})]})}):null}r(2265)},6554:function(e,t,r){"use strict";let s;r.d(t,{AU:function(){return y},CP:function(){return d},Cs:function(){return f},E7:function(){return b},IP:function(){return j},Ir:function(){return h},Xp:function(){return p},gK:function(){return g},i8:function(){return u},nM:function(){return x},uu:function(){return m}});let i="fruitDeliveryMockDB",a=[{id:1,name:"蔬菜類",sortOrder:1},{id:2,name:"水果類",sortOrder:2},{id:3,name:"肉品",sortOrder:3},{id:4,name:"海鮮",sortOrder:4},{id:5,name:"丸類",sortOrder:5},{id:6,name:"火鍋料",sortOrder:6}],o=[{id:1,name:"高麗菜",category:"蔬菜類",price:50,isPriceByWeight:!0,imageUrl:"https://via.placeholder.com/80?text=高麗菜",description:"新鮮高麗菜",stock:100,options:[]},{id:2,name:"蘋果",category:"水果類",price:80,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=蘋果",description:"香甜蘋果",stock:50,options:[]},{id:3,name:"豬五花",category:"肉品",price:120,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=豬五花",description:"美味豬五花",stock:30,options:[]},{id:4,name:"鮭魚片",category:"海鮮",price:250,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=鮭魚片",description:"新鮮鮭魚片",stock:20,options:[]},{id:5,name:"香菇貢丸",category:"丸類",price:90,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=貢丸",description:"Q彈香菇貢丸",stock:80,options:[]},{id:6,name:"金針菇",category:"蔬菜類",price:30,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=金針菇",description:"火鍋必備金針菇",stock:120,options:[]},{id:7,name:"珍珠奶茶",category:"飲料",price:60,isPriceByWeight:!1,imageUrl:"https://via.placeholder.com/80?text=珍奶",description:"經典珍珠奶茶",stock:999,options:[{groupName:"甜度",type:"single",required:!0,values:["無糖","微糖","半糖","正常糖"]},{groupName:"冰塊",type:"single",required:!0,values:["去冰","微冰","少冰","正常冰"]},{groupName:"加料",type:"multiple",required:!1,values:["珍珠","椰果","布丁"]}]}],n=[{id:1,name:"高麗菜",minStock:50,batches:[{quantity:80,unitCost:25,purchaseDate:"2025-08-01"},{quantity:20,unitCost:30,purchaseDate:"2025-08-05"},{quantity:10,unitCost:28,purchaseDate:"2025-08-07"}]},{id:2,name:"蘋果",minStock:30,batches:[{quantity:50,unitCost:60,purchaseDate:"2025-08-02"},{quantity:15,unitCost:62,purchaseDate:"2025-08-06"}]},{id:3,name:"豬五花",minStock:20,batches:[{quantity:30,unitCost:90,purchaseDate:"2025-08-03"}]},{id:4,name:"鮭魚片",minStock:10,batches:[{quantity:15,unitCost:200,purchaseDate:"2025-08-04"}]},{id:5,name:"香菇貢丸",minStock:40,batches:[{quantity:80,unitCost:70,purchaseDate:"2025-08-01"}]},{id:6,name:"金針菇",minStock:60,batches:[{quantity:120,unitCost:20,purchaseDate:"2025-08-02"}]}],c=[{id:1,customerName:"王小明",customerPhone:"0912345678",deliveryAddress:"台北市信義區市府路1號",totalAmount:350,status:"待處理",orderDate:"2025-08-08 10:30",items:[{productId:1,name:"高麗菜",quantity:1,unitPrice:50,options:[],isPriceByWeight:!1},{productId:2,name:"蘋果",quantity:2,unitPrice:80,options:[],isPriceByWeight:!1},{productId:5,name:"香菇貢丸",quantity:1,unitPrice:90,options:[],isPriceByWeight:!1}]},{id:2,customerName:"陳大華",customerPhone:"0922334455",deliveryAddress:"新北市板橋區縣民大道二段7號",totalAmount:200,status:"已確認",orderDate:"2025-08-08 11:00",items:[{productId:7,name:"青江菜",quantity:3,unitPrice:40,options:[],isPriceByWeight:!1},{productId:8,name:"香蕉",quantity:1,unitPrice:60,options:[],isPriceByWeight:!1}]},{id:3,customerName:"林美玲",customerPhone:"0933445566",deliveryAddress:"桃園市中壢區中正路100號",totalAmount:120,status:"待處理",orderDate:"2025-08-08 12:15",items:[{productId:1,name:"高麗菜",quantity:1,unitPrice:0,options:[],isPriceByWeight:!0},{productId:3,name:"豬五花",quantity:1,unitPrice:120,options:[],isPriceByWeight:!1}]},{id:4,customerName:"張小華",customerPhone:"0987654321",deliveryAddress:"台中市西屯區台灣大道三段",totalAmount:80,status:"待處理",orderDate:"2025-08-09 09:00",items:[{productId:1,name:"高麗菜",quantity:2,unitPrice:0,options:[],isPriceByWeight:!0},{productId:2,name:"蘋果",quantity:1,unitPrice:80,options:[],isPriceByWeight:!1}]}];{let e=localStorage.getItem(i);if(e)try{s=JSON.parse(e),console.log("Loaded DB from localStorage:",s)}catch(e){console.error("Error parsing localStorage DB, using default:",e),s={categories:a,products:o,inventory:n,orders:c}}else console.log("No DB found in localStorage, using default."),s={categories:a,products:o,inventory:n,orders:c}}let l=()=>{try{localStorage.setItem(i,JSON.stringify(s)),console.log("Saving DB to localStorage:",s)}catch(e){console.error("Error saving DB to localStorage:",e)}},d=()=>[...s.categories],u=e=>{let t={id:Math.max(...s.categories.map(e=>e.id),0)+1,name:e,sortOrder:s.categories.length+1};return s.categories.push(t),l(),t},m=e=>{s.categories=s.categories.filter(t=>t.id!==e),l()},p=()=>[...s.products],g=e=>{let t=Math.max(...s.products.map(e=>e.id),0)+1,r={...e,id:t};return s.products.push(r),l(),r},x=e=>{s.products=s.products.map(t=>t.id===e.id?e:t),l()},h=e=>{s.products=s.products.filter(t=>t.id!==e),l()},y=()=>[...s.orders],b=(e,t)=>{s.orders=s.orders.map(r=>r.id===e?{...r,status:t}:r),l()},f=e=>{s.orders=s.orders.map(t=>t.id===e.id?e:t),l()},j=()=>[...s.categories].sort((e,t)=>e.sortOrder-t.sortOrder).map(e=>({categoryName:e.name,sortOrder:e.sortOrder,products:s.products.filter(t=>t.category===e.name).map(e=>({id:e.id,name:e.name,price:e.price,imageUrl:e.imageUrl,isPriceByWeight:e.isPriceByWeight}))}))}},function(e){e.O(0,[971,23,744],function(){return e(e.s=5467)}),_N_E=e.O()}]);